---
description: NetExec v1.2.0 åŠŸèƒ½æ¦‚è¿°
cover: ../.gitbook/assets/IMG_4087.png
coverY: 0
layout:
  cover:
    visible: true
    size: full
  title:
    visible: true
  description:
    visible: true
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# ğŸ“¡ v1.2.0 - ItsAlwaysDNS

å¤§å®¶å¥½ï¼

è·ç¦»ä¸Šæ¬¡å‘å¸ƒå·²ç»æœ‰ä¸€æ®µæ—¶é—´äº†ã€‚æˆ‘ä»¬ç°åœ¨æœ‰äº†è¿™ä¹ˆå¤šå¾ˆæ£’çš„åŠŸèƒ½,æ–°ç‰ˆæœ¬çš„å‘å¸ƒæ—©å°±åº”è¯¥åˆ°æ¥ã€‚ä½†é¦–å…ˆ,è¦æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…å’Œåœ¨ discord æœåŠ¡å™¨ä¸Šæä¾›æƒ³æ³•ã€æäº¤é—®é¢˜å’Œå‚ä¸è®¨è®ºçš„äººã€‚è®©æˆ‘ä»¬æ·±å…¥äº†è§£è¿™äº›ä»¤äººæƒŠå¹çš„æ–°æ¨¡å—å’ŒåŠŸèƒ½çš„é•¿åˆ—è¡¨,ä»æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªé‡å¤§å…¬å‘Šå¼€å§‹ã€‚

<figure><img src="../.gitbook/assets/the-office.gif" alt=""><figcaption><p>Woop woop</p></figcaption></figure>

## NetExec å·²åœ¨ Kali ä¸Šå¯ç”¨:rocket:

æœ€å¤§çš„æ–°é—»æ˜¯,åœ¨ [@arszilla](https://x.com/arszilla) çš„å·¨å¤§å¸®åŠ©ä¸‹,è¿™ä¸ªç‰ˆæœ¬ä¹Ÿå¯ä»¥åœ¨ kali ä¸Šä½¿ç”¨äº†ã€‚ç»è¿‡å¤§çº¦ 3 ä¸ªæœˆçš„ Kali ç«¯åŒ…æ›´æ–°,ä¸€åˆ‡éƒ½å·²å‡†å¤‡å°±ç»ªã€‚æ‰€ä»¥ç°åœ¨ä½ å¯ä»¥ç›´æ¥ç”¨ apt å®‰è£…æœ€æ–°ç‰ˆæœ¬:

<figure><img src="../.gitbook/assets/image (8).png" alt=""><figcaption><p>ä½¿ç”¨ apt å®‰è£… NetExec</p></figcaption></figure>

## æ€»æ˜¯ DNS ...

... è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ç°åœ¨æœ‰äº†å®Œå…¨é›†æˆçš„ DNS é€‰é¡¹,æ„Ÿè°¢ [@XiaoliChan](https://x.com/Memory_before)ï¼ä½ å¯ä»¥ä½¿ç”¨ `--dns-server` æŒ‡å®š DNS æœåŠ¡å™¨,æˆ–ä½¿ç”¨ `--dns-tcp` å¼ºåˆ¶ä½¿ç”¨ TCP è¿›è¡Œ DNSã€‚è¿™ä¹Ÿå…è®¸ä½ ä½¿ç”¨ `-6` å¼ºåˆ¶ä½¿ç”¨ IPv6,å¹¶ä½¿ç”¨ `--dns-timeout` è®¾ç½® DNS è¶…æ—¶ã€‚

![æŒ‡å®š dns æœåŠ¡å™¨](https://github.com/Pennyw0rth/NetExec-Wiki/assets/50464194/42925ec8-c693-48ae-9c02-bb4ef27a1b0a)

## æ˜¯æ—¶å€™æ”¶é›†å‡­è¯äº†ğŸ’°

å¬è¯´è¿‡ SCCM å—ï¼Ÿä½ ç°åœ¨å¯ä»¥ä½¿ç”¨æ–°çš„æ ‡å¿— `--sccm` å¯¼å‡ºæ‰€æœ‰ç”± DPAPI å­˜å‚¨çš„ SCCM å‡­è¯ã€‚æ­¤å¤–è¿˜æœ‰å¾ˆå¤šæ–°æ¨¡å—å¯ä»¥è·å–å„ç§è½¯ä»¶å­˜å‚¨çš„å‡­è¯,å¦‚ MobaXtermã€mRemoteNGã€ä¸€äº› vnc æœåŠ¡å™¨è½¯ä»¶å’Œ Google Refresh Tokens,æ„Ÿè°¢ [@zblurx](https://x.com/_zblurx)ï¼

<figure><img src="https://github.com/Pennyw0rth/NetExec-Wiki/assets/50464194/5301e0f8-39cf-4716-894f-75e8bd197f40" alt=""><figcaption><p>Looting SCCM</p></figcaption></figure>

<figure><img src="https://github.com/Pennyw0rth/NetExec-Wiki/assets/50464194/be55049d-45cf-4b52-be81-502c2b6e0013" alt=""><figcaption><p>Looting MobaXterm</p></figcaption></figure>

<div data-full-width="false">

<figure><img src="https://github.com/Pennyw0rth/NetExec-Wiki/assets/50464194/3b919e10-6b67-414e-af11-000645e33d4e" alt=""><figcaption><p>Looting mRemoteNG</p></figcaption></figure>

</div>

<figure><img src="https://github.com/Pennyw0rth/NetExec-Wiki/assets/50464194/ced41d32-e8ba-4463-af77-d2ce0d9801e8" alt=""><figcaption><p>Looting VNC</p></figcaption></figure>

## Looting PuTTY

æ­¤å¤–,æ„Ÿè°¢ [@NeffIsBack](https://x.com/al3x_n3ff) çš„è´¡çŒ®,ç°åœ¨ä¹Ÿå¯ä»¥è·å–å­˜å‚¨åœ¨ PuTTY ä¸­çš„å‡­è¯å’Œ RSA ç§é’¥ã€‚

<figure><img src="https://github.com/Pennyw0rth/NetExec-Wiki/assets/50464194/0dd0c207-b244-4244-8668-f7587602453b" alt=""><figcaption><p>ä» PuTTY è·å– RSA ç§é’¥å’Œä»£ç†å‡­è¯</p></figcaption></figure>

## Extract obsolete operating systems from LDAP

ä½¿ç”¨æ–°çš„ LDAP æ¨¡å— `-M obsolete`,ä½ å¯ä»¥æŸ¥è¯¢ LDAP ä¸­çš„è¿‡æ—¶æ“ä½œç³»ç»Ÿï¼ç”± [@Shad0wC0ntr0ller](https://x.com/Shad0wCntr0ller) å¼€å‘ã€‚

## New LDAP flag for retrieving active Users on the Domain

æ–°çš„ LDAP æ ‡å¿— `--active-users` ä¸ `--users` å…·æœ‰ç›¸åŒçš„ç”¨é€”,ä½†ä¼šè¿‡æ»¤æ‰å·²åœç”¨çš„è´¦æˆ·ã€‚ç”± [@termanix](https://github.com/termanix) å¼€å‘ã€‚

## New SMB Module Printerbug

ç°åœ¨å¯ä»¥ä½¿ç”¨ NetExec åˆ©ç”¨è‘—åçš„ Printerbug å¼ºåˆ¶è®¤è¯æŠ€æœ¯,æ»¥ç”¨ MS-RPRNï¼ç”± [@lodos2005](https://github.com/lodos2005) å¼€å‘ã€‚

<div data-full-width="false">

<img src="https://github.com/Pennyw0rth/NetExec-Wiki/assets/50464194/94a83b39-5bec-4934-931b-e33353dc4529" alt="Coercing authentications using NetExec and the new Printerbug module">

</div>

![Relaying the incoming connection](https://github.com/Pennyw0rth/NetExec-Wiki/assets/50464194/bd0f18e7-3a94-421b-b763-1fc7445e7c60)

{% embed url="https://www.thehacker.recipes/ad/movement/mitm-and-coerced-authentications/ms-rprn" %}

## ä½¿ç”¨ SMB å¯»æ‰¾ ADCS

ç°åœ¨æœ‰ä¸€ä¸ªæ–°çš„ SMB æ¨¡å—,å¯ä»¥æšä¸¾ certsrv.exe çš„ DCERPC ç«¯ç‚¹,è¡¨æ˜æœåŠ¡å™¨æ˜¯ä¸€ä¸ª CAã€‚å®ƒè¿˜ä¼šæšä¸¾ CA æ˜¯å¦å®¹æ˜“å—åˆ° ESC8 çš„æ”»å‡»ã€‚ç”± [@0xjbb](https://github.com/0xjbb) å¼€å‘ã€‚

![ä½¿ç”¨ SMB DCERPC å¯»æ‰¾ ADCS](https://github.com/Pennyw0rth/NetExec-Wiki/assets/50464194/babcd4a5-c96d-4705-b164-d205e0f1b685)

## æ–°çš„ LDAP æ¨¡å—æšä¸¾ userPassword å’Œ unixUserPassword å±æ€§

æœ‰äº›è½¯ä»¶ä¼šåœ¨ LDAP å±æ€§ `userPassword` å’Œ `unixUserPassword` ä¸­å¡«å……å¯èƒ½çš„æ˜æ–‡å‡­è¯ã€‚æ–°çš„ LDAP æ¨¡å— `-M get-userPasswsord` å’Œ `-M get-unixUserPassword` å°†æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·çš„è¿™äº›å±æ€§ã€‚ç”± [@Syzik](https://x.com/SyzikSecu) å¼€å‘ã€‚

![image](https://github.com/Pennyw0rth/NetExec-Wiki/assets/50464194/a01986e8-62ee-496f-ae92-6cfc168a1f31)

## æ–°çš„ Winlogon è‡ªåŠ¨ç™»å½•æ¨¡å—

Windows å…è®¸é…ç½®åœ¨å¯åŠ¨æ—¶è‡ªåŠ¨ç™»å½•æœºå™¨çš„ç”¨æˆ·ã€‚ä½¿ç”¨ [@swisskyrepo](https://x.com/pentest_swissky) å¼€å‘çš„æ–° SMB æ¨¡å—,ä½ ç°åœ¨å¯ä»¥è·å–å­˜å‚¨åœ¨æ³¨å†Œè¡¨ `HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon` ä¸­ç”¨äºè¯¥ç™»å½•è¿‡ç¨‹çš„é”®å€¼ **DefaultDomainNameã€DefaultPasswordã€DefaultUserNameã€AutoAdminLogon** çš„å†…å®¹ã€‚

![ä»æ³¨å†Œè¡¨è·å–è‡ªåŠ¨ç™»å½•å‡­è¯](https://github.com/Pennyw0rth/NetExec-Wiki/assets/50464194/dcaf5906-db93-409a-9937-dbf82ca728b6)

{% embed url="https://learn.microsoft.com/en-us/troubleshoot/windows-server/user-profiles-and-logon/turn-on-automatic-logon" %}

## åŸå§‹ LDAP æŸ¥è¯¢

ç°åœ¨æœ‰ä¸€ä¸ªæ–°çš„ LDAP æ ‡å¿— `--query "(Object)" "Filter"`,ä½¿ç”¨æ ‡å‡†çš„ ldapsearch è¯­æ³•å¯ä»¥å¿«é€ŸæŸ¥æ‰¾ LDAP ä¸­çš„å±æ€§ã€‚ç”± [@NeffIsBack](https://x.com/al3x_n3ff) å¼€å‘ã€‚

![image](https://github.com/Pennyw0rth/NetExec-Wiki/assets/50464194/145e0573-bf1e-4e18-971b-3f098506c8e3)

## æ›´æ–°çš„ LDAP å’Œ SMB ç”¨æˆ·æšä¸¾

SMB/LDAP `--users` å’Œ LDAP `--active-users` æ ‡å¿—ç°åœ¨å…è®¸è¿‡æ»¤ç‰¹å®šç”¨æˆ·ï¼æ„Ÿè°¢ [@Marshall-Hallenbeck](https://x.com/MJHallenbeck)ã€‚

<div data-full-width="false">

<img src="https://github.com/Pennyw0rth/NetExec-Wiki/assets/50464194/f191bd1f-af45-4cdc-bd84-e82b74bff502" alt="">

 

<img src="https://github.com/Pennyw0rth/NetExec-Wiki/assets/50464194/e2c4e3eb-ec14-42a7-a895-2df852d2cfe1" alt="">

</div>

![](https://github.com/Pennyw0rth/NetExec-Wiki/assets/50464194/28d9208f-b7be-4f06-9505-d1b76e6b4201)

## æ›´æ–°çš„ PSO æ¨¡å—

[@sebrink](https://x.com/_sandw1ch) æ›´æ–°äº† pso æ¨¡å—,è¯¥æ¨¡å—å¯ä»¥è·å–åŸŸä¸­æ‰€æœ‰ç»†ç²’åº¦å¯†ç ç­–ç•¥,ä¸ºæ¨¡å—å¸¦æ¥äº†å…¨æ–°çš„å¤–è§‚,å¹¶ä¿®å¤äº†ä¸€ä¸ªå…³é”® bug - å¦‚æœç­–ç•¥é™„åŠ åˆ°å¤šä¸ªå¯¹è±¡,è¯¥ç­–ç•¥ä¸ä¼šæ˜¾ç¤ºã€‚

![æ–°çš„ pso æ¨¡å—](https://github.com/Pennyw0rth/NetExec-Wiki/assets/50464194/899e73df-e4b0-4db6-9de1-2527bff470d2)

## èº«ä»½éªŒè¯é™æµ

æ—§çš„ `--jitter` é€‰é¡¹å·²é‡æ–°è®¾è®¡,ä»¥å¯ç”¨èº«ä»½éªŒè¯é™æµã€‚å¦‚æœä½ æƒ³æ›´åŠ éšè”½æˆ–ç»•è¿‡é”å®šæœºåˆ¶,è¿™éå¸¸æœ‰ç”¨ã€‚ç”± [@NeffIsBack](https://x.com/al3x_n3ff) å¼€å‘ã€‚

## Tab è¡¥å…¨

æ„Ÿè°¢ [@Adamkadaban](https://x.com/Adamkadaban),å¦‚æœä½¿ç”¨ pipx å®‰è£…,NetExec ç°åœ¨æ”¯æŒ tab è¡¥å…¨ï¼æŸ¥çœ‹å®‰è£…é¡µé¢äº†è§£è®¾ç½®ã€‚

<figure><img src="../.gitbook/assets/nxc-argcomplete.gif" alt=""><figcaption><p>ä½¿ç”¨ NetExec çš„ Tab è¡¥å…¨</p></figcaption></figure>

## PowerShell å‘½ä»¤æ‰§è¡Œé‡æ„

å¯¹ NetExec ä¸­çš„ PowerShell åŠŸèƒ½è¿›è¡Œäº†é‡å¤§æ”¹è¿›,ä¿®å¤äº†å¤§å¤šæ•° bug å¹¶æ”¹è¿›äº†æ•´ä½“å¯ç”¨æ€§å’Œç¨³å®šæ€§ã€‚æ··æ·†å’Œ Amsi ç»•è¿‡ä¹Ÿè¢«è®¾ç½®ä¸ºéé»˜è®¤,å› ä¸ºå®ƒä»¬ç»å¸¸è¢«æ€æ¯’è½¯ä»¶æ ‡è®°ã€‚ä¸€ä¸ªå¾ˆå¥½çš„å‰¯ä½œç”¨æ˜¯ `ps32` é™çº§ç°åœ¨å¯ä»¥ç»•è¿‡ Windows DefenderğŸ˜„\
ç”± [@Marshall-Hallenbeck](https://x.com/MJHallenbeck) å¼€å‘ã€‚

<figure><img src="../.gitbook/assets/image.png" alt=""><figcaption><p>ä½¿ç”¨ --force-ps32 ç»•è¿‡ Windows Defender</p></figcaption></figure>

## ç»“è¯­

å¦‚æœä½ æƒ³è¯¦ç»†äº†è§£æ‰€æœ‰æ›´æ”¹æˆ–ä¸‹è½½æœ€æ–°çš„ç‹¬ç«‹äºŒè¿›åˆ¶æ–‡ä»¶,è¯·æŸ¥çœ‹ github é¡µé¢:

{% embed url="https://github.com/Pennyw0rth/NetExec/releases/tag/v1.2.0" %}
